{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createBlock as _createBlock, normalizeStyle as _normalizeStyle, renderList as _renderList, Fragment as _Fragment, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = {\n  class: \"orgchart-container\"\n};\nconst _hoisted_2 = {\n  class: \"page-header\"\n};\nconst _hoisted_3 = {\n  class: \"page-actions\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"card loading-card\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"card error-card\"\n};\nconst _hoisted_6 = {\n  key: 2,\n  class: \"orgchart-wrapper card\"\n};\nconst _hoisted_7 = {\n  class: \"orgchart-actions\"\n};\nconst _hoisted_8 = {\n  class: \"zoom-controls\"\n};\nconst _hoisted_9 = {\n  class: \"zoom-level\"\n};\nconst _hoisted_10 = {\n  class: \"orgchart-filters\"\n};\nconst _hoisted_11 = {\n  class: \"p-input-icon-left search-box\"\n};\nconst _hoisted_12 = {\n  class: \"chart-container\",\n  ref: \"chartContainer\"\n};\nconst _hoisted_13 = {\n  key: 0,\n  class: \"employee-details\"\n};\nconst _hoisted_14 = {\n  class: \"employee-header\"\n};\nconst _hoisted_15 = {\n  class: \"employee-avatar\"\n};\nconst _hoisted_16 = [\"src\", \"alt\"];\nconst _hoisted_17 = {\n  key: 1,\n  class: \"employee-initials\"\n};\nconst _hoisted_18 = {\n  class: \"employee-title\"\n};\nconst _hoisted_19 = {\n  class: \"employee-position\"\n};\nconst _hoisted_20 = {\n  class: \"employee-info\"\n};\nconst _hoisted_21 = {\n  class: \"info-item\"\n};\nconst _hoisted_22 = {\n  class: \"info-value\"\n};\nconst _hoisted_23 = [\"href\"];\nconst _hoisted_24 = {\n  key: 0,\n  class: \"info-item\"\n};\nconst _hoisted_25 = {\n  class: \"info-value\"\n};\nconst _hoisted_26 = {\n  key: 1,\n  class: \"info-item\"\n};\nconst _hoisted_27 = {\n  class: \"info-value\"\n};\nconst _hoisted_28 = {\n  key: 2,\n  class: \"info-item\"\n};\nconst _hoisted_29 = {\n  class: \"info-value\"\n};\nconst _hoisted_30 = {\n  class: \"direct-reports-list\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Button = _resolveComponent(\"Button\");\n  const _component_ProgressSpinner = _resolveComponent(\"ProgressSpinner\");\n  const _component_Dropdown = _resolveComponent(\"Dropdown\");\n  const _component_InputText = _resolveComponent(\"InputText\");\n  const _component_OrgNode = _resolveComponent(\"OrgNode\");\n  const _component_Tag = _resolveComponent(\"Tag\");\n  const _component_Divider = _resolveComponent(\"Divider\");\n  const _component_Dialog = _resolveComponent(\"Dialog\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[3] || (_cache[3] = _createElementVNode(\"h1\", {\n    class: \"page-title\"\n  }, \"Organization Chart\", -1)), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_Button, {\n    label: \"Export\",\n    icon: \"pi pi-download\",\n    class: \"p-button-outlined\",\n    onClick: $setup.exportOrgChart\n  }, null, 8, [\"onClick\"]), _createVNode(_component_Button, {\n    label: $setup.showDepartments ? 'Hide Departments' : 'Show Departments',\n    icon: $setup.showDepartments ? 'pi pi-eye-slash' : 'pi pi-eye',\n    class: \"p-button-outlined ml-2\",\n    onClick: $setup.toggleDepartments\n  }, null, 8, [\"label\", \"icon\", \"onClick\"])])]), $setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_ProgressSpinner, {\n    class: \"spinner\"\n  }), _cache[4] || (_cache[4] = _createElementVNode(\"p\", null, \"Loading organization data...\", -1))])) : $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_cache[5] || (_cache[5] = _createElementVNode(\"i\", {\n    class: \"pi pi-exclamation-triangle error-icon\"\n  }, null, -1)), _cache[6] || (_cache[6] = _createElementVNode(\"h3\", null, \"Error Loading Data\", -1)), _createElementVNode(\"p\", null, _toDisplayString($setup.error), 1), _createVNode(_component_Button, {\n    label: \"Retry\",\n    icon: \"pi pi-refresh\",\n    onClick: $setup.loadOrgData\n  }, null, 8, [\"onClick\"])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_Button, {\n    icon: \"pi pi-minus\",\n    class: \"p-button-rounded p-button-text\",\n    onClick: $setup.zoomOut\n  }, null, 8, [\"onClick\"]), _createElementVNode(\"span\", _hoisted_9, _toDisplayString(Math.round($setup.zoomLevel * 100)) + \"%\", 1), _createVNode(_component_Button, {\n    icon: \"pi pi-plus\",\n    class: \"p-button-rounded p-button-text\",\n    onClick: $setup.zoomIn\n  }, null, 8, [\"onClick\"])]), _createElementVNode(\"div\", _hoisted_10, [$setup.departments.length > 0 ? (_openBlock(), _createBlock(_component_Dropdown, {\n    key: 0,\n    modelValue: $setup.selectedDepartment,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.selectedDepartment = $event),\n    options: $setup.departmentOptions,\n    optionLabel: \"name\",\n    placeholder: \"Filter by Department\",\n    class: \"department-filter\",\n    onChange: $setup.filterByDepartment\n  }, null, 8, [\"modelValue\", \"options\", \"onChange\"])) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_11, [_cache[7] || (_cache[7] = _createElementVNode(\"i\", {\n    class: \"pi pi-search\"\n  }, null, -1)), _createVNode(_component_InputText, {\n    modelValue: $setup.searchTerm,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.searchTerm = $event),\n    placeholder: \"Search employees\",\n    onInput: $setup.filterBySearch\n  }, null, 8, [\"modelValue\", \"onInput\"])])])]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"div\", {\n    class: \"orgchart\",\n    ref: \"orgchart\",\n    style: _normalizeStyle({\n      transform: `scale(${$setup.zoomLevel})`\n    })\n  }, [$setup.rootNode ? (_openBlock(), _createBlock(_component_OrgNode, {\n    key: 0,\n    node: $setup.rootNode,\n    \"show-departments\": $setup.showDepartments,\n    \"highlighted-nodes\": $setup.highlightedNodes,\n    onNodeClick: $setup.viewEmployeeDetails\n  }, null, 8, [\"node\", \"show-departments\", \"highlighted-nodes\", \"onNodeClick\"])) : _createCommentVNode(\"\", true)], 4)], 512)])), _createVNode(_component_Dialog, {\n    visible: $setup.employeeDialogVisible,\n    \"onUpdate:visible\": _cache[2] || (_cache[2] = $event => $setup.employeeDialogVisible = $event),\n    header: $setup.selectedEmployee ? `${$setup.selectedEmployee.first_name} ${$setup.selectedEmployee.last_name}` : 'Employee Details',\n    modal: true,\n    dismissableMask: true,\n    style: {\n      width: '500px'\n    },\n    closeOnEscape: true\n  }, {\n    footer: _withCtx(() => [_createVNode(_component_Button, {\n      label: \"View Profile\",\n      icon: \"pi pi-user\",\n      onClick: $setup.goToEmployeeProfile\n    }, null, 8, [\"onClick\"])]),\n    default: _withCtx(() => [$setup.selectedEmployee ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [$setup.selectedEmployee.profile_image ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      src: $setup.selectedEmployee.profile_image,\n      alt: $setup.selectedEmployee.first_name,\n      class: \"employee-image\"\n    }, null, 8, _hoisted_16)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_17, _toDisplayString($setup.getInitials($setup.selectedEmployee)), 1))]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"h3\", null, _toDisplayString($setup.selectedEmployee.first_name) + \" \" + _toDisplayString($setup.selectedEmployee.last_name), 1), _createElementVNode(\"div\", _hoisted_19, _toDisplayString($setup.selectedEmployee.job_title), 1), $setup.selectedEmployee.department_name ? (_openBlock(), _createBlock(_component_Tag, {\n      key: 0,\n      value: $setup.selectedEmployee.department_name,\n      severity: \"info\",\n      class: \"department-tag\"\n    }, null, 8, [\"value\"])) : _createCommentVNode(\"\", true)])]), _createVNode(_component_Divider), _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"div\", _hoisted_21, [_cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n      class: \"info-label\"\n    }, \"Email\", -1)), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"a\", {\n      href: `mailto:${$setup.selectedEmployee.email}`\n    }, _toDisplayString($setup.selectedEmployee.email), 9, _hoisted_23)])]), $setup.selectedEmployee.phone ? (_openBlock(), _createElementBlock(\"div\", _hoisted_24, [_cache[9] || (_cache[9] = _createElementVNode(\"div\", {\n      class: \"info-label\"\n    }, \"Phone\", -1)), _createElementVNode(\"div\", _hoisted_25, _toDisplayString($setup.selectedEmployee.phone), 1)])) : _createCommentVNode(\"\", true), $setup.selectedEmployee.manager_name ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [_cache[10] || (_cache[10] = _createElementVNode(\"div\", {\n      class: \"info-label\"\n    }, \"Manager\", -1)), _createElementVNode(\"div\", _hoisted_27, _toDisplayString($setup.selectedEmployee.manager_name), 1)])) : _createCommentVNode(\"\", true), $setup.directReports.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [_cache[11] || (_cache[11] = _createElementVNode(\"div\", {\n      class: \"info-label\"\n    }, \"Direct Reports\", -1)), _createElementVNode(\"div\", _hoisted_29, [_createElementVNode(\"ul\", _hoisted_30, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.directReports, report => {\n      return _openBlock(), _createElementBlock(\"li\", {\n        key: report.id\n      }, _toDisplayString(report.first_name) + \" \" + _toDisplayString(report.last_name), 1);\n    }), 128))])])])) : _createCommentVNode(\"\", true)])])) : _createCommentVNode(\"\", true)]),\n    _: 1\n  }, 8, [\"visible\", \"header\"])]);\n}","map":{"version":3,"names":["class","key","ref","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_Button","label","icon","onClick","$setup","exportOrgChart","showDepartments","toggleDepartments","loading","_hoisted_4","_component_ProgressSpinner","error","_hoisted_5","_toDisplayString","loadOrgData","_hoisted_6","_hoisted_7","_hoisted_8","zoomOut","_hoisted_9","Math","round","zoomLevel","zoomIn","_hoisted_10","departments","length","_createBlock","_component_Dropdown","modelValue","selectedDepartment","_cache","$event","options","departmentOptions","optionLabel","placeholder","onChange","filterByDepartment","_createCommentVNode","_hoisted_11","_component_InputText","searchTerm","onInput","filterBySearch","_hoisted_12","style","_normalizeStyle","transform","rootNode","_component_OrgNode","node","highlightedNodes","onNodeClick","viewEmployeeDetails","_component_Dialog","visible","employeeDialogVisible","header","selectedEmployee","first_name","last_name","modal","dismissableMask","width","closeOnEscape","footer","_withCtx","goToEmployeeProfile","default","_hoisted_13","_hoisted_14","_hoisted_15","profile_image","src","alt","_hoisted_16","_hoisted_17","getInitials","_hoisted_18","_hoisted_19","job_title","department_name","_component_Tag","value","severity","_component_Divider","_hoisted_20","_hoisted_21","_hoisted_22","href","email","_hoisted_23","phone","_hoisted_24","_hoisted_25","manager_name","_hoisted_26","_hoisted_27","directReports","_hoisted_28","_hoisted_29","_hoisted_30","_Fragment","_renderList","report","id","_"],"sources":["/home/pi/projects/intranet/frontend/src/views/OrgChart.vue"],"sourcesContent":["<template>\r\n    <div class=\"orgchart-container\">\r\n      <div class=\"page-header\">\r\n        <h1 class=\"page-title\">Organization Chart</h1>\r\n        <div class=\"page-actions\">\r\n          <Button \r\n            label=\"Export\" \r\n            icon=\"pi pi-download\" \r\n            class=\"p-button-outlined\" \r\n            @click=\"exportOrgChart\"\r\n          />\r\n          <Button \r\n            :label=\"showDepartments ? 'Hide Departments' : 'Show Departments'\" \r\n            :icon=\"showDepartments ? 'pi pi-eye-slash' : 'pi pi-eye'\" \r\n            class=\"p-button-outlined ml-2\" \r\n            @click=\"toggleDepartments\"\r\n          />\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Loading state -->\r\n      <div v-if=\"loading\" class=\"card loading-card\">\r\n        <ProgressSpinner class=\"spinner\" />\r\n        <p>Loading organization data...</p>\r\n      </div>\r\n      \r\n      <!-- Error state -->\r\n      <div v-else-if=\"error\" class=\"card error-card\">\r\n        <i class=\"pi pi-exclamation-triangle error-icon\"></i>\r\n        <h3>Error Loading Data</h3>\r\n        <p>{{ error }}</p>\r\n        <Button label=\"Retry\" icon=\"pi pi-refresh\" @click=\"loadOrgData\" />\r\n      </div>\r\n      \r\n      <!-- Organization Chart -->\r\n      <div v-else class=\"orgchart-wrapper card\">\r\n        <div class=\"orgchart-actions\">\r\n          <div class=\"zoom-controls\">\r\n            <Button icon=\"pi pi-minus\" class=\"p-button-rounded p-button-text\" @click=\"zoomOut\" />\r\n            <span class=\"zoom-level\">{{ Math.round(zoomLevel * 100) }}%</span>\r\n            <Button icon=\"pi pi-plus\" class=\"p-button-rounded p-button-text\" @click=\"zoomIn\" />\r\n          </div>\r\n          \r\n          <div class=\"orgchart-filters\">\r\n            <Dropdown \r\n              v-if=\"departments.length > 0\"\r\n              v-model=\"selectedDepartment\" \r\n              :options=\"departmentOptions\" \r\n              optionLabel=\"name\" \r\n              placeholder=\"Filter by Department\" \r\n              class=\"department-filter\"\r\n              @change=\"filterByDepartment\"\r\n            />\r\n            \r\n            <div class=\"p-input-icon-left search-box\">\r\n              <i class=\"pi pi-search\" />\r\n              <InputText v-model=\"searchTerm\" placeholder=\"Search employees\" @input=\"filterBySearch\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"chart-container\" ref=\"chartContainer\">\r\n          <div class=\"orgchart\" ref=\"orgchart\" :style=\"{ transform: `scale(${zoomLevel})` }\">\r\n            <!-- Recursive tree component -->\r\n            <OrgNode \r\n              v-if=\"rootNode\" \r\n              :node=\"rootNode\" \r\n              :show-departments=\"showDepartments\"\r\n              :highlighted-nodes=\"highlightedNodes\"\r\n              @node-click=\"viewEmployeeDetails\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Employee Details Dialog -->\r\n      <Dialog \r\n        v-model:visible=\"employeeDialogVisible\" \r\n        :header=\"selectedEmployee ? `${selectedEmployee.first_name} ${selectedEmployee.last_name}` : 'Employee Details'\" \r\n        :modal=\"true\"\r\n        :dismissableMask=\"true\"\r\n        :style=\"{ width: '500px' }\"\r\n        :closeOnEscape=\"true\"\r\n      >\r\n        <div v-if=\"selectedEmployee\" class=\"employee-details\">\r\n          <div class=\"employee-header\">\r\n            <div class=\"employee-avatar\">\r\n              <img \r\n                v-if=\"selectedEmployee.profile_image\" \r\n                :src=\"selectedEmployee.profile_image\" \r\n                :alt=\"selectedEmployee.first_name\" \r\n                class=\"employee-image\"\r\n              />\r\n              <div v-else class=\"employee-initials\">\r\n                {{ getInitials(selectedEmployee) }}\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"employee-title\">\r\n              <h3>{{ selectedEmployee.first_name }} {{ selectedEmployee.last_name }}</h3>\r\n              <div class=\"employee-position\">{{ selectedEmployee.job_title }}</div>\r\n              <Tag \r\n                v-if=\"selectedEmployee.department_name\" \r\n                :value=\"selectedEmployee.department_name\"\r\n                severity=\"info\"\r\n                class=\"department-tag\"\r\n              />\r\n            </div>\r\n          </div>\r\n          \r\n          <Divider />\r\n          \r\n          <div class=\"employee-info\">\r\n            <div class=\"info-item\">\r\n              <div class=\"info-label\">Email</div>\r\n              <div class=\"info-value\">\r\n                <a :href=\"`mailto:${selectedEmployee.email}`\">{{ selectedEmployee.email }}</a>\r\n              </div>\r\n            </div>\r\n            \r\n            <div v-if=\"selectedEmployee.phone\" class=\"info-item\">\r\n              <div class=\"info-label\">Phone</div>\r\n              <div class=\"info-value\">{{ selectedEmployee.phone }}</div>\r\n            </div>\r\n            \r\n            <div v-if=\"selectedEmployee.manager_name\" class=\"info-item\">\r\n              <div class=\"info-label\">Manager</div>\r\n              <div class=\"info-value\">{{ selectedEmployee.manager_name }}</div>\r\n            </div>\r\n            \r\n            <div v-if=\"directReports.length > 0\" class=\"info-item\">\r\n              <div class=\"info-label\">Direct Reports</div>\r\n              <div class=\"info-value\">\r\n                <ul class=\"direct-reports-list\">\r\n                  <li v-for=\"report in directReports\" :key=\"report.id\">\r\n                    {{ report.first_name }} {{ report.last_name }}\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <template #footer>\r\n          <Button \r\n            label=\"View Profile\" \r\n            icon=\"pi pi-user\" \r\n            @click=\"goToEmployeeProfile\" \r\n          />\r\n        </template>\r\n      </Dialog>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { ref, computed, onMounted, nextTick } from 'vue';\r\n  import { useStore } from 'vuex';\r\n  import { useRouter } from 'vue-router';\r\n  import Button from 'primevue/button';\r\n  import Dropdown from 'primevue/dropdown';\r\n  import InputText from 'primevue/inputtext';\r\n  import Dialog from 'primevue/dialog';\r\n  import Divider from 'primevue/divider';\r\n  import Tag from 'primevue/tag';\r\n  import ProgressSpinner from 'primevue/progressspinner';\r\n  import OrgNode from '../components/orgchart/OrgNode.vue';\r\n  \r\n  export default {\r\n    name: 'OrgChartView',\r\n    components: {\r\n      Button,\r\n      Dropdown,\r\n      InputText,\r\n      Dialog,\r\n      Divider,\r\n      Tag,\r\n      ProgressSpinner,\r\n      OrgNode\r\n    },\r\n    \r\n    setup() {\r\n      const store = useStore();\r\n      const router = useRouter();\r\n      \r\n      // State\r\n      const loading = ref(false);\r\n      const error = ref(null);\r\n      const orgData = ref([]);\r\n      const departments = ref([]);\r\n      const rootNode = ref(null);\r\n      const zoomLevel = ref(1);\r\n      const showDepartments = ref(true);\r\n      const selectedDepartment = ref(null);\r\n      const searchTerm = ref('');\r\n      const highlightedNodes = ref([]);\r\n      const employeeDialogVisible = ref(false);\r\n      const selectedEmployee = ref(null);\r\n      const directReports = ref([]);\r\n      \r\n      // DOM refs\r\n      const chartContainer = ref(null);\r\n      const orgchart = ref(null);\r\n      \r\n      // Computed properties\r\n      const departmentOptions = computed(() => {\r\n        const options = [{ id: null, name: 'All Departments' }];\r\n        departments.value.forEach(dept => {\r\n          options.push(dept);\r\n        });\r\n        return options;\r\n      });\r\n      \r\n      // Methods\r\n      const loadOrgData = async () => {\r\n        try {\r\n          loading.value = true;\r\n          error.value = null;\r\n          \r\n          // Fetch org chart data\r\n          await store.dispatch('users/fetchOrgChart');\r\n          orgData.value = store.state.users.orgChart;\r\n          \r\n          // Fetch departments\r\n          await store.dispatch('departments/fetchDepartments');\r\n          departments.value = store.state.departments.list;\r\n          \r\n          // Build tree structure\r\n          buildOrgTree();\r\n        } catch (err) {\r\n          console.error('Error loading org chart data:', err);\r\n          error.value = 'Failed to load organization data. Please try again.';\r\n        } finally {\r\n          loading.value = false;\r\n        }\r\n      };\r\n      \r\n      const buildOrgTree = () => {\r\n        if (!orgData.value || orgData.value.length === 0) {\r\n          rootNode.value = null;\r\n          return;\r\n        }\r\n        \r\n        // Create nodes map\r\n        const nodesMap = new Map();\r\n        \r\n        // First pass: Create all nodes\r\n        orgData.value.forEach(employee => {\r\n          nodesMap.set(employee.id, {\r\n            ...employee,\r\n            children: []\r\n          });\r\n        });\r\n        \r\n        // Second pass: Build parent-child relationships\r\n        let root = null;\r\n        \r\n        orgData.value.forEach(employee => {\r\n          const node = nodesMap.get(employee.id);\r\n          \r\n          if (employee.manager_id) {\r\n            // Add to parent's children\r\n            const parent = nodesMap.get(employee.manager_id);\r\n            if (parent) {\r\n              parent.children.push(node);\r\n            }\r\n          } else {\r\n            // This is a root node (no manager)\r\n            root = node;\r\n          }\r\n        });\r\n        \r\n        // Sort children by last name in each node\r\n        const sortChildren = (node) => {\r\n          if (node.children && node.children.length > 0) {\r\n            node.children.sort((a, b) => \r\n              a.last_name.localeCompare(b.last_name) || \r\n              a.first_name.localeCompare(b.first_name)\r\n            );\r\n            \r\n            node.children.forEach(child => sortChildren(child));\r\n          }\r\n        };\r\n        \r\n        if (root) {\r\n          sortChildren(root);\r\n        }\r\n        \r\n        rootNode.value = root;\r\n      };\r\n      \r\n      const zoomIn = () => {\r\n        zoomLevel.value = Math.min(2, zoomLevel.value + 0.1);\r\n      };\r\n      \r\n      const zoomOut = () => {\r\n        zoomLevel.value = Math.max(0.5, zoomLevel.value - 0.1);\r\n      };\r\n      \r\n      const toggleDepartments = () => {\r\n        showDepartments.value = !showDepartments.value;\r\n      };\r\n      \r\n      const filterByDepartment = () => {\r\n        if (!selectedDepartment.value || selectedDepartment.value.id === null) {\r\n          highlightedNodes.value = [];\r\n          buildOrgTree(); // Reset to original tree\r\n          return;\r\n        }\r\n        \r\n        // Find employees in the selected department\r\n        const deptEmployees = orgData.value.filter(\r\n          emp => emp.department_id === selectedDepartment.value.id\r\n        );\r\n        \r\n        // Highlight these nodes\r\n        highlightedNodes.value = deptEmployees.map(emp => emp.id);\r\n        \r\n        // Rebuild the tree to show all nodes (highlighted ones will be styled differently)\r\n        buildOrgTree();\r\n      };\r\n      \r\n      const filterBySearch = () => {\r\n        if (!searchTerm.value.trim()) {\r\n          highlightedNodes.value = [];\r\n          buildOrgTree(); // Reset to original tree\r\n          return;\r\n        }\r\n        \r\n        const term = searchTerm.value.toLowerCase();\r\n        \r\n        // Find employees matching the search term\r\n        const matchingEmployees = orgData.value.filter(\r\n          emp => emp.first_name.toLowerCase().includes(term) || \r\n                 emp.last_name.toLowerCase().includes(term) ||\r\n                 emp.job_title?.toLowerCase().includes(term) ||\r\n                 emp.email.toLowerCase().includes(term)\r\n        );\r\n        \r\n        // Highlight these nodes\r\n        highlightedNodes.value = matchingEmployees.map(emp => emp.id);\r\n        \r\n        // Rebuild the tree to show all nodes (highlighted ones will be styled differently)\r\n        buildOrgTree();\r\n      };\r\n      \r\n      const viewEmployeeDetails = async (employee) => {\r\n        selectedEmployee.value = employee;\r\n        \r\n        // Get direct reports\r\n        try {\r\n          const reports = await store.dispatch('users/fetchDirectReports', employee.id);\r\n          directReports.value = reports || [];\r\n        } catch (error) {\r\n          console.error('Error fetching direct reports:', error);\r\n          directReports.value = [];\r\n        }\r\n        \r\n        employeeDialogVisible.value = true;\r\n      };\r\n      \r\n      const goToEmployeeProfile = () => {\r\n        if (selectedEmployee.value) {\r\n          router.push(`/users/${selectedEmployee.value.id}`);\r\n        }\r\n      };\r\n      \r\n      const getInitials = (employee) => {\r\n        if (!employee) return '';\r\n        \r\n        const first = employee.first_name.charAt(0).toUpperCase();\r\n        const last = employee.last_name.charAt(0).toUpperCase();\r\n        \r\n        return `${first}${last}`;\r\n      };\r\n      \r\n      const exportOrgChart = () => {\r\n        // In a real application, this would create a PDF or image export\r\n        // For this implementation, we'll just show a message\r\n        store.dispatch('showToast', {\r\n          severity: 'info',\r\n          summary: 'Export',\r\n          detail: 'Organization chart export functionality would be implemented here'\r\n        });\r\n      };\r\n      \r\n      // Load data when component mounts\r\n      onMounted(async () => {\r\n        await loadOrgData();\r\n        \r\n        // Center the chart after it's rendered\r\n        nextTick(() => {\r\n          if (chartContainer.value && orgchart.value) {\r\n            chartContainer.value.scrollLeft = \r\n              (orgchart.value.scrollWidth - chartContainer.value.clientWidth) / 2;\r\n          }\r\n        });\r\n      });\r\n      \r\n      return {\r\n        loading,\r\n        error,\r\n        rootNode,\r\n        departments,\r\n        departmentOptions,\r\n        zoomLevel,\r\n        showDepartments,\r\n        selectedDepartment,\r\n        searchTerm,\r\n        highlightedNodes,\r\n        employeeDialogVisible,\r\n        selectedEmployee,\r\n        directReports,\r\n        chartContainer,\r\n        orgchart,\r\n        \r\n        loadOrgData,\r\n        zoomIn,\r\n        zoomOut,\r\n        toggleDepartments,\r\n        filterByDepartment,\r\n        filterBySearch,\r\n        viewEmployeeDetails,\r\n        goToEmployeeProfile,\r\n        getInitials,\r\n        exportOrgChart\r\n      };\r\n    }\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .orgchart-container {\r\n    padding: 1rem;\r\n  }\r\n  \r\n  .page-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 1.5rem;\r\n  }\r\n  \r\n  .page-title {\r\n    font-size: 1.5rem;\r\n    font-weight: 600;\r\n    margin: 0;\r\n  }\r\n  \r\n  .loading-card, .error-card {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 3rem;\r\n    text-align: center;\r\n  }\r\n  \r\n  .spinner {\r\n    width: 50px;\r\n    height: 50px;\r\n    margin-bottom: 1rem;\r\n  }\r\n  \r\n  .error-icon {\r\n    font-size: 3rem;\r\n    color: var(--danger-color);\r\n    margin-bottom: 1rem;\r\n  }\r\n  \r\n  .orgchart-wrapper {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 1rem;\r\n  }\r\n  \r\n  .orgchart-actions {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 1rem;\r\n  }\r\n  \r\n  .zoom-controls {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  \r\n  .zoom-level {\r\n    margin: 0 0.5rem;\r\n    min-width: 3rem;\r\n    text-align: center;\r\n  }\r\n  \r\n  .orgchart-filters {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 1rem;\r\n  }\r\n  \r\n  .department-filter {\r\n    width: 200px;\r\n  }\r\n  \r\n  .search-box {\r\n    width: 200px;\r\n  }\r\n  \r\n  .chart-container {\r\n    overflow: auto;\r\n    border: 1px solid var(--surface-border);\r\n    padding: 2rem;\r\n    display: flex;\r\n    justify-content: center;\r\n    min-height: 500px;\r\n    background-color: var(--surface-ground);\r\n  }\r\n  \r\n  .orgchart {\r\n    transform-origin: center top;\r\n    transition: transform 0.3s;\r\n  }\r\n  \r\n  /* Employee details styles */\r\n  .employee-details {\r\n    padding: 1rem 0;\r\n  }\r\n  \r\n  .employee-header {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  \r\n  .employee-avatar {\r\n    width: 80px;\r\n    height: 80px;\r\n    border-radius: 50%;\r\n    overflow: hidden;\r\n    margin-right: 1.5rem;\r\n    background-color: var(--primary-color);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n  \r\n  .employee-image {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n  }\r\n  \r\n  .employee-initials {\r\n    font-size: 2rem;\r\n    font-weight: 600;\r\n    color: white;\r\n  }\r\n  \r\n  .employee-title h3 {\r\n    margin: 0 0 0.5rem 0;\r\n    font-weight: 600;\r\n  }\r\n  \r\n  .employee-position {\r\n    color: var(--text-color-secondary);\r\n    margin-bottom: 0.5rem;\r\n  }\r\n  \r\n  .department-tag {\r\n    font-size: 0.75rem;\r\n  }\r\n  \r\n  .employee-info {\r\n    margin-top: 1rem;\r\n  }\r\n  \r\n  .info-item {\r\n    margin-bottom: 1rem;\r\n  }\r\n  \r\n  .info-label {\r\n    font-weight: 500;\r\n    margin-bottom: 0.25rem;\r\n    color: var(--text-color-secondary);\r\n  }\r\n  \r\n  .info-value {\r\n    color: var(--text-color);\r\n  }\r\n  \r\n  .direct-reports-list {\r\n    list-style-type: none;\r\n    padding-left: 0;\r\n    margin: 0;\r\n  }\r\n  \r\n  .direct-reports-list li {\r\n    padding: 0.25rem 0;\r\n  }\r\n  \r\n  /* Responsive adjustments */\r\n  @media screen and (max-width: 768px) {\r\n    .page-header {\r\n      flex-direction: column;\r\n      align-items: flex-start;\r\n    }\r\n    \r\n    .page-actions {\r\n      margin-top: 1rem;\r\n      width: 100%;\r\n      display: flex;\r\n      gap: 0.5rem;\r\n    }\r\n    \r\n    .orgchart-actions {\r\n      flex-direction: column;\r\n      align-items: stretch;\r\n    }\r\n    \r\n    .zoom-controls {\r\n      margin-bottom: 1rem;\r\n      justify-content: center;\r\n    }\r\n    \r\n    .orgchart-filters {\r\n      flex-direction: column;\r\n      width: 100%;\r\n    }\r\n    \r\n    .department-filter,\r\n    .search-box {\r\n      width: 100%;\r\n    }\r\n    \r\n    .chart-container {\r\n      min-height: 400px;\r\n    }\r\n    \r\n    .employee-header {\r\n      flex-direction: column;\r\n      text-align: center;\r\n    }\r\n    \r\n    .employee-avatar {\r\n      margin-right: 0;\r\n      margin-bottom: 1rem;\r\n    }\r\n  }\r\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}